<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>首页</title>

    <link rel="shortcut icon" href="favicon.ico">
    <link href="../static/css/bootstrap.min.css?v=3.3.7" rel="stylesheet">
    <link href="../static/css/font-awesome.css?v=4.4.0" rel="stylesheet">

    <!-- Morris -->
    <link href="../static/css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">

    <!-- Gritter -->
    <link href="../static/js/plugins/gritter/jquery.gritter.css" rel="stylesheet">

    <link href="../static/css/animate.css" rel="stylesheet">
    <link href="../static/css/style.css?v=4.1.0" rel="stylesheet">

</head>

<body class="gray-bg">
<shiro:hasPermission name="order:*:*">
    <div class="wrapper wrapper-content">
        <div class="row">
            <div class="col-sm-3" >
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-success pull-right">月</span>
                        <h5>收入</h5>
                    </div>
                    <div class="ibox-content" id="income">
                        <h1 class="no-margins"></h1>
<!--                        <div class="stat-percent font-bold text-success">98% <i class="fa fa-bolt"></i></div>-->
                        <small id="month"></small>
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-info pull-right">全年</span>
                        <h5>订单</h5>
                    </div>
                    <div class="ibox-content" id="order">
<!--                        <h1 class="no-margins"></h1>-->
<!--                        <div class="stat-percent font-bold text-info">20% <i class="fa fa-level-up"></i>-->
<!--                        </div>-->
                        <small></small>
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-primary pull-right">今天</span>
                        <h5>访客</h5>
                    </div>
                    <div class="ibox-content" id="count">
                        <h1 class="no-margins"></h1>
<!--                        <div class="stat-percent font-bold text-navy">44% <i class="fa fa-level-up"></i>-->
<!--                        </div>-->
                        <small>新访客</small>
                    </div>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <span class="label label-danger pull-right">今年</span>
                        <h5>总收入</h5>
                    </div>
                    <div class="ibox-content">
                        <h1 class="no-margins">80,600</h1>
<!--                        <div class="stat-percent font-bold text-danger">38% <i class="fa fa-level-down"></i>-->
<!--                        </div>-->
                        <small>全年</small>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>订单</h5>
                        <div class="pull-right">
                            <div class="btn-group">
<!--                                <button type="button" class="btn btn-xs btn-white active">周</button>-->
<!--                                <button type="button" class="btn btn-xs btn-white">月</button>-->
<!--                                <button type="button" class="btn btn-xs btn-white">年</button>-->
                            </div>
                        </div>
                    </div>
                    <div class="ibox-content">
                        <div class="row">
                            <div class="col-sm-9">
                                <div class="flot-chart">
                                    <div class="flot-chart-content" id="flot-dashboard-chart"></div>
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <ul class="stat-list">
                                    <li>
                                        <h2 class="no-margins" id="test1"></h2>
                                        <small>订单总数</small>
                                        <div class="stat-percent" id="test2">90% <i class="fa fa-level-up text-navy"></i>
                                        </div>
                                        <div class="progress progress-mini">
                                            <div style="width: 90%;" class="progress-bar" id="test3"></div>
                                        </div>
                                    </li>
                                    <li>
                                        <h2 class="no-margins " id="test4"></h2>
                                        <small>最近一周订单</small>
                                        <div class="stat-percent" id="test5">60% <i class="fa fa-level-down text-navy"></i>
                                        </div>
                                        <div class="progress progress-mini">
                                            <div style="width: 60%;" class="progress-bar" id="test6"></div>
                                        </div>
                                    </li>
                                    <li>
                                        <h2 class="no-margins ">9,180</h2>
                                        <small>最近一周销售额</small>
                                        <div class="stat-percent">22% <i class="fa fa-bolt text-navy"></i>
                                        </div>
                                        <div class="progress progress-mini">
                                            <div style="width: 22%;" class="progress-bar"></div>
                                        </div>
                                    </li>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>


        <div class="row">


            <div class="col-sm-12">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>公司地点</h5>
                                <div class="ibox-tools">
                                    <a class="collapse-link">
                                        <i class="fa fa-chevron-up"></i>
                                    </a>
                                    <a class="close-link">
                                        <i class="fa fa-times"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="ibox-content">

                                <div class="row">
                                    <div class="col-sm-6">
                                        <table class="table table-hover margin bottom">
                                            <thead>
                                                <tr>
                                                    <th style="width: 1%" class="text-center">序号</th>
                                                    <th>地点</th>
                                                    <th class="text-center">开业时间</th>
                                                    <th class="text-center">销售额</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="text-center">1</td>
                                                    <td>北京
                                                        </small>
                                                    </td>
                                                    <td class="text-center small">2017.9.15</td>
                                                    <td class="text-center"><span class="label label-primary">&yen;148300.00</span>
                                                    </td>

                                                </tr>
                                                <tr>
                                                    <td class="text-center">2</td>
                                                    <td>郑州
                                                    </td>
                                                    <td class="text-center small">2018.6.14</td>
                                                    <td class="text-center"><span class="label label-primary">&yen;113270.00</span>
                                                    </td>

                                                </tr>
                                                <tr>
                                                    <td class="text-center">3</td>
                                                    <td>太原
                                                    </td>
                                                    <td class="text-center small">2018.12.17</td>
                                                    <td class="text-center"><span class="label label-warning">&yen;99125.00</span>
                                                    </td>

                                                </tr>
                                                <tr>
                                                    <td class="text-center">4</td>
                                                    <td>福州</td>
                                                    <td class="text-center small">2019.5.21</td>
                                                    <td class="text-center"><span class="label label-primary">&yen;87344.00</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">5</td>
                                                    <td>广州</td>
                                                    <td class="text-center small">2020.2.24</td>
                                                    <td class="text-center"><span class="label label-primary">&yen;109235.00</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">6</td>
                                                    <td>上海</td>
                                                    <td class="text-center small">2021.8.31</td>
                                                    <td class="text-center"><span class="label label-primary">&yen;179657.00</span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="col-sm-6">
                                        <div id="world-map" style="height: 300px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 全局js -->
    <script src="../static/js/jquery.min.js?v=2.1.4"></script>
    <script src="../static/js/bootstrap.min.js?v=3.3.7"></script>



    <!-- Flot -->
    <script src="../static/js/plugins/flot/jquery.flot.js"></script>
    <script src="../static/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
    <script src="../static/js/plugins/flot/jquery.flot.spline.js"></script>
    <script src="../static/js/plugins/flot/jquery.flot.resize.js"></script>
    <script src="../static/js/plugins/flot/jquery.flot.pie.js"></script>
    <script src="../static/js/plugins/flot/jquery.flot.symbol.js"></script>

    <!-- Peity -->
    <script src="../static/js/plugins/peity/jquery.peity.min.js"></script>
    <script src="../static/js/demo/peity-demo.js"></script>

    <!-- 自定义js -->
    <script src="../static/js/content.js?v=1.0.0"></script>


    <!-- jQuery UI -->
    <script src="../static/js/plugins/jquery-ui/jquery-ui.min.js"></script>

    <!-- Jvectormap -->
    <script src="../static/js/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
    <script src="../static/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>

    <!-- EayPIE -->
    <script src="../static/js/plugins/easypiechart/jquery.easypiechart.js"></script>

    <!-- Sparkline -->
    <script src="../static/js/plugins/sparkline/jquery.sparkline.min.js"></script>

    <!-- Sparkline demo data  -->
    <script src="../static/js/demo/sparkline-demo.js"></script>

    <script crossorigin="anonymous" integrity="sha512-hjx+SPhu1qxXHVo0A5AfAiso7QfjsF59qQVEbNgLpef2vwPJsiWd9Mv5ms0TNHFlRETxIaWzbN3WaSYbt+2aLQ==" src="https://lib.baomitu.com/echarts/5.2.0/echarts.common.js"></script>
    <script crossorigin="anonymous" integrity="sha512-Rw7ABPI0CoYquQZEa2QMaeMR5q5XESMNp4uGOsXPzU9JnvWW6S27+pz8fAjVlL7/kq6Q12MtGVcPkJya2blqAg==" src="https://lib.baomitu.com/echarts/5.2.0/echarts.js"></script>
    <script   type="text/javascript" th:inline="javascript">
        <!--实现首页收入模块的更新12/14-->
        var table=$("#income");
        $(function(){
            $.post("sellContract/income",function(data){
                $.each(data,function(key,value){
                    //解决没有订单显示为null的问题

                        table.prepend("<h1 class='no-margins'>"+value+"</h1>");

                    $("#income h1:eq(3)").remove();
                    $("#income h1:eq(2)").remove();
                    $("#income h1:eq(1)").remove();

                })
                $.each(data,function(key,value){
                    table.append("<small>"+value+"月总收入"+"</small>");
                    //下面这里删除是我蒙出来的，这里还不清楚到底如何正确删除
                    $("#income small:eq(2)").remove();
                })
            })
        });
        var table2=$("#order");
        var table3 = $("#count");
        $(function(){

            $.post("sellContract/order",function(data){
                $.each(data,function(key,value){
                    table2.prepend("<h1 class='no-margins'>"+value+"</h1>");
                    table3.prepend("<h1 class='no-margins'>"+value+"</h1>");
                    $("#count h1:eq(1)").remove();
                    $("#count h1:eq(2)").remove();
                })
                $("#order h1:eq(0)").remove();
                $("#order h1:eq(1)").remove();
                $.each(data,function(key,value){
                    table2.append("<small>"+value+"年新订单"+"</small>");
                    //下面这里删除是我蒙出来的，这里还不清楚到底如何正确删除
                    $("#order small:eq(2)").remove();
                })
            })
        });
        $(document).ready(function () {
            $('.chart').easyPieChart({
                barColor: '#f8ac59',
                //                scaleColor: false,
                scaleLength: 5,
                lineWidth: 4,
                size: 80
            });

            $('.chart2').easyPieChart({
                barColor: '#1c84c6',
                //                scaleColor: false,
                scaleLength: 5,
                lineWidth: 4,
                size: 80
            });


            $(function(){
                drowEcharts();
            })

            function drowEcharts(){

                var myecharts = echarts.init(document.getElementById("flot-dashboard-chart"));

                $.ajax({
                    url:"sellContract/select_order_day",
                    success:function(rs){
                        var test1 = rs.allOrder;
                        $("#test1").append("<h2 class=\"no-margins\">"+test1+"</h2>")
                        document.getElementById('test2').innerHTML=test1+"%"+" <i class=\"fa fa-level-up text-navy\"></i>";
                        document.getElementById('test3').style.width=test1+"%";
                        var test2 = rs.weekOrder;
                        $("#test4").append("<h2 class=\"no-margins\">"+test2+"</h2>")
                        document.getElementById('test5').innerHTML=test2+"%"+" <i class=\"fa fa-level-up text-navy\"></i>";
                        document.getElementById('test6').style.width=test2+"%";
                        var option = {
                            //用于设置图表在div显示内边距
                            grid: {
                                top: 35,
                                left: 55,
                                right: 45,
                                bottom: 20,
                                width:'auto',
                                height:'auto'
                            },
                            tooltip: {
                                trigger: 'axis',
                                axisPointer: {
                                    type: 'cross',
                                    crossStyle: {
                                        color: '#999'
                                    }
                                }
                            },
                            toolbox: {
                                feature: {
                                    dataView: { show: false, readOnly: false },
                                    magicType: { show: false, type: ['line', 'bar'] },
                                    restore: { show: false },
                                    saveAsImage: { show: false }
                                }
                            },
                            legend: {
                                data: ['订单', '销售额']
                            },
                            xAxis: [
                                {
                                    type: 'category',
                                    data: rs.days,
                                    axisPointer: {
                                        type: 'shadow'
                                    }
                                }
                            ],
                            yAxis: [
                                {
                                    type: 'value',
                                    name: '订单',
                                    min: 0,
                                    max: 10,
                                    interval: 2,
                                    axisLabel: {
                                        formatter: '{value} 件'
                                    }
                                },
                                {
                                    type: 'value',
                                    name: '销售额',
                                    min: 0,
                                    max: 25,
                                    interval: 5,
                                    axisLabel: {
                                        formatter: '{value} 元'
                                    }
                                }
                            ],
                            series: [

                                {
                                    name: '订单',
                                    type: 'bar',
                                    data: rs.orders
                                },
                                {
                                    name: '销售额',
                                    type: 'line',
                                    yAxisIndex: 1,
                                    data: [2.0, 2.2, 3.3, 4.5, 6.3, 10.2, 20.3, 23.4, 23.0, 16.5, 12.0, 6.2]
                                }
                            ]
                        };
                        option && myecharts.setOption(option);
                    }
                })
                //实现浏览器缩放大小自适应
                $('#flot-dashboard-chart').resize(function(){
                    myecharts.resize();
                });
            }


            var mapData = {

                "CN": 120,

            };

            $('#world-map').vectorMap({
                map: 'world_mill_en',
                backgroundColor: "transparent",
                regionStyle: {
                    initial: {
                        fill: '#e4e4e4',
                        "fill-opacity": 0.9,
                        stroke: 'none',
                        "stroke-width": 0,
                        "stroke-opacity": 0
                    }
                },

                series: {
                    regions: [{
                        values: mapData,
                        scale: ["#1ab394", "#22d6b1"],
                        normalizeFunction: 'polynomial'
                    }]
                },
            });
        });
    </script>

<!--    <script type="text/javascript" src="http://tajs.qq.com/stats?sId=9051096" charset="UTF-8"></script>-->
<!--    &lt;!&ndash;统计代码，可删除&ndash;&gt;-->
</shiro:hasPermission>
</body>
</html>
